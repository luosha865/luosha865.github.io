	<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.15-DEV" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Lucene索引文件学习 &middot;  </title>

  
  <link rel="stylesheet" href="http://luosha865.github.io/css/poole.css">
  <link rel="stylesheet" href="http://luosha865.github.io/css/syntax.css">
  <link rel="stylesheet" href="http://luosha865.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="" />
</head>

	<body class="">
		<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://luosha865.github.io/"><h1></h1></a>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
    </ul>

    <p>&copy; 2015. All rights reserved. </p>
  </div>
</div>


		<div class="content container">
			<div class="post">
			 	<h1>Lucene索引文件学习</h1>
			  <span class="post-date">Wed, Feb 4, 2015</span>
			      <p><span style="font-size: 12px;"> 最近在做搜索，抽空看一下lucene，资料挺多的，不过大部分都是3.x了……在对着官方文档大概看一下。</span></p>

<p><span style="font-size: 12px;">优化后的lucene索引文件(4.9.0)</span></p>

<p><span style="font-size: 12px;"><img title="NewImage.png" src="http://sword865.com/blog/wp-content/uploads/2015/02/NewImage.png" alt="NewImage" width="200" height="146" border="0" /></span></p>

<p><span style="font-size: 12px;">一、段文件</span></p>

<p><span style="font-size: 12px;">1.段文件：segments_5p和segments.gen。</span></p>

<p><span style="font-size: 12px;">segments.gen保存当前段文件版本信息。</span></p>

<ul style="color: #353833; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <li>
    <span style="font-size: 12px;"><tt style="font-size: 1.2em;">segments.gen</tt>: GenHeader, Generation, Generation, Footer</span>
  </li>
</ul>

<p><span style="font-size: 12px;">segments_N（segments_5p）保存最新的段的信息，包括段的个数，每个段的段名、文档数等信息。</span></p>

<ul style="font-size: 12px; color: #353833; font-family: Arial, Helvetica, sans-serif;">
  <li>
    <span style="font-size: 12px;"><tt style="font-size: 1.2em;">segments_N</tt>: Header, Version, NameCounter, SegCount, <SegName, SegCodec, DelGen, DeletionCount, FieldInfosGen, DocValuesGen, UpdatesFiles><sup style="font-size: 0.6em;">SegCount</sup>, CommitUserData, Footer</span>
  </li>
</ul>

<p><span style="font-size: 12px;">  源码参考：SegmentInfos.read(Directory directory, String segmentFileName):</span></p>

<p><span style="font-size: 12px;">2.段信息：*.si，存储段的基本信息。</span></p>

<ul style="color: #353833; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <li>
    <span style="font-size: 12px;"><tt style="font-size: 1.2em;">.si</tt>: Header, SegVersion, SegSize, IsCompoundFile, Diagnostics, Attributes, Files</span>
  </li>
</ul>

<p><span style="font-size: 12px;">       只对4.0-4.5使用，新版已经抛弃了，可以无视。  </span></p>

<p><span style="font-size: 12px;">二、域文件</span></p>

<p><span style="font-size: 12px;">1.域(field)：*.fnm ，存储域的信息。</span></p>

<ul style="font-size: 12px; color: #353833; font-family: Arial, Helvetica, sans-serif;">
  <li>
    <span style="font-size: 12px;">FieldInfos (.fnm) &#8211;> Header,FieldsCount, <FieldName,FieldNumber, FieldBits,DocValuesBits,DocValuesGen,Attributes> <sup style="font-size: 0.6em; color: #353833; font-family: Arial, Helvetica, sans-serif;">FieldsCount</sup>,Footer</span>
  </li>
</ul>

<div>
  <p style="margin: 0px; font-size: 11px; font-family: Monaco;">
    <span style="font-size: 12px;">  源码参考：org.apache.lucene.codecs.lucene46.Lucene46FieldInfosFormat</span>
  </p>
  
  <p style="margin: 0px; font-size: 11px; font-family: Monaco;">
    <span style="font-size: 12px;">2.域(field)索引：*.fdx，存储到域数据的指针。</span>
  </p>
</div>

<ul style="color: #353833; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <li>
    <span style="font-size: 12px;">FieldsIndex (.fdx) &#8211;> <Header>, <ChunkIndex></span>
  </li>
</ul>

<p><span style="font-size: 12px;">   源码参考：org.apache.lucene.codecs.lucene41.Lucene41StoredFieldsFormat</span></p>

<p><span style="font-size: 12px;">3.域(field)数据：*.fdt，存储文档的域，话说这个结构比较复杂，简单列一下。</span></p>

<ul style="font-size: 12px; color: #353833; font-family: Arial, Helvetica, sans-serif;">
  <li>
    <span style="font-size: 12px;">FieldData (.fdt) &#8211;> <Header>, PackedIntsVersion, <Chunk><sup style="font-size: 0.6em;">ChunkCount</sup></span>
  </li>
  <li>
    <span style="font-size: 12px;">ChunkCount is not known in advance and is the number of chunks necessary to store all document of the segment</span>
  </li>
  <li>
    <span style="font-size: 12px;">Chunk &#8211;> DocBase, ChunkDocs, DocFieldCounts, DocLengths, <CompressedDocs></span>
  </li>
</ul>

<p><span style="font-size: 12px;">  源码参考：org.apache.lucene.codecs.lucene41.Lucene41StoredFieldsFormat</span></p>

<p><span style="font-size: 12px;">三、字典文件</span></p>

<p><span style="font-size: 12px;">4.项(term)字典：*.tim，存储项的信息。</span></p>

<ul style="color: #353833; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <li>
    <span style="font-size: 12px;">TermsDict (.tim) &#8211;> Header, <em>PostingsHeader</em>, NodeBlock<sup style="font-size: 0.6em;">NumBlocks</sup>, FieldSummary, DirOffset, Footer</span>
  </li>
</ul>

<p><span style="font-size: 12px;">  源码参考：org.apache.lucene.codecs.lucene41.Lucene41PostingsFormat</span></p>

<p><span style="font-size: 12px;">5.项(term)索引：*.tip，到项字典的索引。</span></p>

<ul style="color: #353833; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <li>
    <span style="font-size: 12px;">TermsIndex (.tip) &#8211;> Header, FSTIndex<sup style="font-size: 0.6em;">NumFields</sup> <IndexStartFP><sup style="font-size: 0.6em;">NumFields</sup>, DirOffset, Footer</span>
  </li>
</ul>

<p><span style="font-size: 12px;">  源码参考：org.apache.lucene.codecs.lucene41.Lucene41PostingsFormat </span></p>

<p><span style="font-size: 12px;">四、其他文件 </span></p>

<p><span style="font-size: 12px;">6.频率：*.doc，包括一个文档列表，列表中每一个项都有一个频数。</span></p>

<ul style="color: #353833; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <li>
    <span style="font-size: 12px;">docFile(.doc) &#8211;> Header, <TermFreqs, SkipData?><sup style="font-size: 0.6em;">TermCount</sup>, Footer</span>
  </li>
</ul>

<p><span style="font-size: 12px;">  源码参考：org.apache.lucene.codecs.lucene41.Lucene41PostingsFormat </span></p>

<p><span style="font-size: 12px;">7.位置：*.pos，存储项在索引中出现的位置信息。</span></p>

<ul style="color: #353833; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <li>
    <span style="font-size: 12px;">PosFile(.pos) &#8211;> Header, <TermPositions> <sup style="font-size: 0.6em;">TermCount</sup>, Footer</span>
  </li>
</ul>

<p><span style="font-size: 12px;">  源码参考：org.apache.lucene.codecs.lucene41.Lucene41PostingsFormat</span></p>

<p><span style="font-size: 12px;"> 8.norm文件：<em>.nvd，</em>.nvm，编码文档和域的长度已经boost factors。</span></p>

<ul style="font-size: 12px; color: #353833; font-family: Arial, Helvetica, sans-serif;">
  <li>
    <span style="font-size: 12px;">Norms data (.nvd) &#8211;> Header,<Uncompressed | TableCompressed | DeltaCompressed><sup style="font-size: 0.6em; color: #353833; font-family: Arial, Helvetica, sans-serif;">NumFields</sup>,Footer</span>
  </li>
</ul>

<p><span style="font-size: 12px;">  源码参考：org.apache.lucene.codecs.lucene49.Lucene49NormsFormat</span></p>

<p><span style="font-size: 12px;"> 除此之外，还可能有一些其他文件，暂且不表。</span></p>

<p><span style="font-size: 12px;"> 参考：</span></p>

<p><span style="font-size: 12px;"><a href="http://lucene.apache.org/core/4_9_0/core/org/apache/lucene/codecs/lucene49/package-summary.html#File_Naming">http://lucene.apache.org/core/4_9_0/core/org/apache/lucene/codecs/lucene49/package-summary.html#File_Naming</a></span></p>

<p><span style="font-size: 12px;"><a href="http://www.cnblogs.com/forfuture1978/category/300665.html">http://www.cnblogs.com/forfuture1978/category/300665.html</a></span></p>

<p> </p>

<p style="margin:0;padding:0;height:1px;overflow:hidden;">
  <a href="http://www.wumii.com/widget/relatedItems" style="border:0;"><img src="http://static.wumii.cn/images/pixel.png" alt="无觅相关文章插件，快速提升流量" style="border:0;padding:0;margin:0;" /></a>
</p>

			</div>

			
		</div>

  </body>
</html>
