	<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.15-DEV" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> R语言系列—-区间估计 &middot; 悟剑阁 </title>

  
  <link rel="stylesheet" href="http://luosha865.github.io/css/poole.css">
  <link rel="stylesheet" href="http://luosha865.github.io/css/syntax.css">
  <link rel="stylesheet" href="http://luosha865.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://luosha865.github.io/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="http://luosha865.github.io/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="悟剑阁" />
</head>

	<body class="">
		<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://luosha865.github.io/"><h1>悟剑阁</h1></a>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="http://luosha865.github.io/">Home</a> </li>
      
        <li><a href="http://luosha865.github.io/post/"> 归档 </a></li>
      
        <li><a href="http://luosha865.github.io/about/"> 关于我 </a></li>
      
    </ul>

    <p>&copy; 2015. All rights reserved. </p>
  </div>
</div>


		<div class="content container">
			<div class="post">
			 	<h1>R语言系列—-区间估计</h1>
			  <span class="post-date">Sat, Jun 30, 2012</span>
			      <p>这一篇讲的是区间估计…..因为这不是一个关于统计学的系列，所以对文中出现的公式不会给予任何证明…..就是这样。</p>

<p>就从一个最简单的正态分布的方差已知时，求均值的置信区间开始吧。</p>

<p>书上的公式告诉我们这个区间是 <img src="http://sword865.com/blog/wp-content/ql-cache/quicklatex.com-23dc436f241aa40067d71af513a9d926_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#111;&#118;&#101;&#114;&#108;&#105;&#110;&#101;&#123;&#120;&#125;&#92;&#112;&#109;&#40;&#92;&#115;&#105;&#103;&#109;&#97;&#47;&#92;&#115;&#113;&#114;&#116;&#123;&#110;&#125;&#41;&#122;&#95;&#123;&#40;&#49;&#45;&#92;&#115;&#105;&#103;&#109;&#97;&#47;&#50;&#41;&#125;" title="Rendered by QuickLaTeX.com" height="21" width="148" style="vertical-align: -7px;" />,其中Z<sub>p</sub>表示的是正态分布N(0,1)下侧的p分位数。</p>

<p>我们用R来实现求得这一结果的过程。下面设x里存储了给出的样本，sigma表示已知的方差，n表示样本的个数， alpha则是(1-置信水平)</p>

<pre class="lang:r decode:true">mean&lt;-mean(x)
ans&lt;-c(mean-sigma*qnorm(1-alpha / 2)/sqrt(n) , mean+sigma*qnorm(1-alpha / 2)/sqrt(n))
</pre>

<p>这样,ans就存储了要求的置信区间。</p>

<p>来解释一下吧，先用mean(x)求出样本的平均值，然后用qnorm(1-alpha / 2)求出Z<sub>1-a/2</sub>，（还记得么？前缀q是分位数函数，）剩下的就是套公式的加减法了。</p>

<p>这里的qnorm(1-alpha / 2)其实省略了很多参数，完整一些的写法是</p>

<pre class="lang:r decode:true">qnorm(1-alpha/2,mean=0,sd=1,lower.tail=TRUE)</pre>

<p>第一个参数就不用解释了，第二,三个参数mean=0,sd=1，表示这是一个标准正态分布(不同于前面，这里增加了mean=和sd=，这种做法的好处是可以改变参数的顺序，但是结果是一样的)，最后一个参数lower.tail这个参数的意思就比较有意思了，官方解释如下：</p>

<p>if TRUE (default), probabilities are <em>P[X &lt;= x]</em>, otherwise, <em>P[X &gt; x]</em>.</p>

<p>明白了么?等于真的话，得出的就是X&lt;=x的分位数，为假的话就是从X&gt;x的方法寻找这个值。一般我们用默认的真就可以了。</p>

<p>接下来我们把它整理成一个函数，方便使用</p>

<pre class="lang:r decode:true">z.test&lt;-function(x,n,sigma,alpha){
mean&lt;-mean(x)
ans&lt;-c(
  mean-sigma*qnorm(1-alpha/2,mean=0,sd=1,lower.tail=TRUE)/sqrt(n),mean+sigma*qnorm(1-alpha/2,mean=0,sd=1,lower.tail=TRUE)/sqrt(n))
ans
}</pre>

<p>这样我们就可以直接使用z.test()完成对u的置信区间的计算。</p>

<p>比如，有10个样本，分别是175,176,173,175,174,173,173,176,173,179。标准差为1.5，求均值95%的置信区间：</p>

<pre class="lang:r decode:true  ">x&lt;-c(175,176,173,175,174,173,173,176,173,179)
z.test(x,10,1.5,0.05)</pre>

<p>则返回置信区间：</p>

<p>[1] 173.7703 175.6297</p>

<p style="margin:0;padding:0;height:1px;overflow:hidden;">
  <a href="http://www.wumii.com/widget/relatedItems" style="border:0;"><img src="http://static.wumii.cn/images/pixel.png" alt="无觅相关文章插件，快速提升流量" style="border:0;padding:0;margin:0;" /></a>
</p>

			</div>

			
		</div>

  </body>
</html>
